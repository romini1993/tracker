<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Multi Chain Scanner No Aggregator</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white p-8">

<h1 class="text-2xl font-bold mb-6">Multi Chain Tracker</h1>

<input id="addr" placeholder="0x address"
class="p-3 bg-gray-900 w-full mb-4">

<button onclick="scan()" class="bg-blue-600 px-6 py-3 rounded">
SCAN
</button>

<table class="w-full mt-6 text-left">
<thead>
<tr>
<th>Network</th>
<th>Token</th>
<th>Balance</th>
</tr>
</thead>

<tbody id="hasil"></tbody>
</table>

<script>

let hasilData = [];

const CHAINS = [

{
name:"ETH",
native:"ETH",
api:`https://api.ethplorer.io/getAddressInfo/`
},

{
name:"BSC",
native:"BNB",
api:`https://api.bscscan.com/api?module=account&action=tokentx&address=`
},

{
name:"POLYGON",
native:"MATIC",
api:`https://api.polygonscan.com/api?module=account&action=tokentx&address=`
}

];


async function scan(){

const address = document.getElementById("addr").value;

hasilData = [];
document.getElementById("hasil").innerHTML = "";

await scanETH(address);
await scanExplorer(address, CHAINS[1]);
await scanExplorer(address, CHAINS[2]);

render();

}



async function scanETH(address){

try{

const res = await fetch(`https://api.ethplorer.io/getAddressInfo/${address}?apiKey=freekey`);
const data = await res.json();

if(data.ETH.balance > 0){

hasilData.push({
network:"ETH",
token:"ETH",
balance:data.ETH.balance
});

}

if(data.tokens){

data.tokens.forEach(t=>{

const bal = t.balance / Math.pow(10,t.tokenInfo.decimals);

if(bal > 0){

hasilData.push({
network:"ETH",
token:t.tokenInfo.symbol,
balance:bal
});

}

});

}

}catch(e){console.log("ETH error")}

}



async function scanExplorer(address, chain){

try{

const res = await fetch(chain.api + address);
const data = await res.json();

const tokens = {};

data.result.forEach(tx=>{

tokens[tx.contractAddress] = {
symbol:tx.tokenSymbol,
decimals:tx.tokenDecimal
};

});

for(const ca in tokens){

// ambil balance tiap contract
const balanceRes = await fetch(
`https://api.allorigins.win/get?url=${encodeURIComponent(
`https://api.bscscan.com/api?module=account&action=tokenbalance&contractaddress=${ca}&address=${address}`
)}`
);

const parsed = await balanceRes.json();
const balData = JSON.parse(parsed.contents);

const bal = balData.result / Math.pow(10,tokens[ca].decimals);

if(bal > 0){

hasilData.push({
network:chain.name,
token:tokens[ca].symbol,
balance:bal
});

}

}

}catch(e){
console.log(chain.name,"error")
}

}



function render(){

document.getElementById("hasil").innerHTML = hasilData.map(d=>`

<tr>
<td>${d.network}</td>
<td>${d.token}</td>
<td>${d.balance.toFixed(4)}</td>
</tr>

`).join("");

}

</script>
</body>
</html>
