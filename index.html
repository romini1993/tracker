<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Chain Portfolio - Bro Minas</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-[#05070a] text-slate-300 min-h-screen py-10 px-4 font-sans">

    <div class="max-w-5xl mx-auto">
        <div class="flex flex-col md:flex-row justify-between items-center mb-10 gap-4">
            <div>
                <h1 class="text-4xl font-black text-white tracking-tighter italic">EVM SCANNER</h1>
                <p class="text-slate-500 text-sm">Scan 11+ Networks secara instan.</p>
            </div>
            <button onclick="copyAllData()" id="copyAllBtn" class="hidden bg-blue-600 hover:bg-blue-500 text-white px-6 py-3 rounded-full font-bold transition-all shadow-lg shadow-blue-900/20">
                üìã Copy Semua Data Koin
            </button>
        </div>

        <div class="bg-[#0f141f] p-6 rounded-3xl border border-slate-800 shadow-2xl mb-8">
            <div class="flex flex-col md:flex-row gap-4">
                <input id="walletAddress" type="text" placeholder="Masukkan Address EVM (0x...)" 
                    class="flex-1 bg-[#1a202c] border border-slate-700 p-4 rounded-2xl focus:outline-none focus:border-blue-500 text-white font-mono placeholder-slate-600">
                <button onclick="trackAssets()" class="bg-white text-black hover:bg-slate-200 px-10 py-4 rounded-2xl font-black transition-all">
                    SCAN SEKARANG
                </button>
            </div>
        </div>

        <div id="statusInfo" class="hidden grid grid-cols-2 md:grid-cols-4 gap-2 mb-6 text-[10px] font-bold uppercase tracking-widest text-slate-500">
            </div>

        <div class="bg-[#0f141f] rounded-3xl border border-slate-800 overflow-hidden shadow-2xl">
            <div class="overflow-x-auto">
                <table class="w-full text-left">
                    <thead class="bg-[#1a202c]">
                        <tr>
                            <th class="p-5 text-xs font-bold text-slate-400 uppercase">Network</th>
                            <th class="p-5 text-xs font-bold text-slate-400 uppercase">Token</th>
                            <th class="p-5 text-xs font-bold text-slate-400 uppercase text-right">Balance</th>
                            <th class="p-5 text-xs font-bold text-slate-400 uppercase">Contract</th>
                        </tr>
                    </thead>
                    <tbody id="resultTable" class="divide-y divide-slate-800">
                        <tr>
                            <td colspan="4" class="p-20 text-center text-slate-600 font-medium italic">Belum ada data. Masukkan address dulu, Bro.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let allAssets = [];

        async function trackAssets() {
            const address = document.getElementById('walletAddress').value.trim();
            const table = document.getElementById('resultTable');
            const statusInfo = document.getElementById('statusInfo');
            const copyBtn = document.getElementById('copyAllBtn');

            if (!address.startsWith('0x') || address.length < 42) {
                alert('Address-nya gak valid, Bro. Cek lagi!');
                return;
            }

            // Reset
            table.innerHTML = '';
            statusInfo.innerHTML = '';
            statusInfo.classList.remove('hidden');
            copyBtn.classList.add('hidden');
            allAssets = [];

            // List Jaringan sesuai request elu
            const chains = [
                "eth", "bsc", "polygon", "arbitrum", "optimism", 
                "avalanche", "base", "manta", "mantle", "zksync", "soneium"
            ];

            // Setup loading status
            chains.forEach(c => {
                statusInfo.innerHTML += `<div id="status-${c}" class="bg-slate-900 p-2 rounded-lg border border-slate-800 text-center">‚è≥ ${c}</div>`;
            });

            try {
                const response = await fetch('https://rpc.ankr.com/multichain', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        jsonrpc: "2.0",
                        method: "ankr_getAccountBalance",
                        params: { 
                            walletAddress: address,
                            blockchain: chains 
                        },
                        id: 1
                    })
                });

                const json = await response.json();
                
                if (json.result && json.result.assets) {
                    allAssets = json.result.assets;
                    
                    if (allAssets.length === 0) {
                        table.innerHTML = '<tr><td colspan="4" class="p-20 text-center text-slate-500">Gak ada koin sama sekali di address ini.</td></tr>';
                    } else {
                        copyBtn.classList.remove('hidden');
                        allAssets.forEach(asset => {
                            // Update status indicator
                            const statusEl = document.getElementById(`status-${asset.blockchain}`);
                            if(statusEl) statusEl.innerHTML = `‚úÖ ${asset.blockchain}`;

                            const row = `
                                <tr class="hover:bg-blue-900/10 transition-colors">
                                    <td class="p-5 font-bold text-blue-400 text-sm">${asset.blockchain.toUpperCase()}</td>
                                    <td class="p-5 font-black text-white">${asset.tokenSymbol}</td>
                                    <td class="p-5 text-right font-mono text-green-400 font-bold">${parseFloat(asset.balance).toLocaleString(undefined, {maximumFractionDigits: 6})}</td>
                                    <td class="p-5 text-slate-600 text-[10px] font-mono">${asset.tokenAddress === '0x0000000000000000000000000000000000000000' ? 'NATIVE' : asset.tokenAddress}</td>
                                </tr>
                            `;
                            table.innerHTML += row;
                        });
                    }
                }
            } catch (err) {
                console.error(err);
                alert('Waduh, koneksi ke API gagal. Coba refresh atau cek address-nya lagi, Bro.');
            } finally {
                statusInfo.classList.add('hidden');
            }
        }

        function copyAllData() {
            if (allAssets.length === 0) return;
            let text = "NETWORK | TOKEN | BALANCE | CONTRACT\n";
            allAssets.forEach(a => {
                text += `${a.blockchain.toUpperCase()} | ${a.tokenSymbol} | ${a.balance} | ${a.tokenAddress}\n`;
            });
            navigator.clipboard.writeText(text);
            alert('Semua data berhasil disalin ke clipboard!');
        }
    </script>
</body>
</html>
