<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mini EVM Portfolio</title>
<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-black text-white p-8">

<h1 class="text-2xl font-bold mb-6">Mini Portfolio RPC</h1>

<input id="addr" placeholder="0x address"
class="p-3 bg-gray-900 w-full mb-4">

<button onclick="scan()" class="bg-blue-600 px-6 py-3 rounded">
SCAN
</button>

<table class="w-full mt-6">
<thead>
<tr>
<th>Network</th>
<th>Token</th>
<th>Balance</th>
</tr>
</thead>

<tbody id="hasil"></tbody>
</table>

<script>

// ===== RPC ENDPOINT =====
const CHAINS = [

{
name:"ETH",
rpc:"https://rpc.ankr.com/eth",
tokens:[
{
symbol:"USDT",
address:"0xdAC17F958D2ee523a2206206994597C13D831ec7",
decimals:6
}
]
},

{
name:"BSC",
rpc:"https://rpc.ankr.com/bsc",
tokens:[
{
symbol:"USDT",
address:"0x55d398326f99059fF775485246999027B3197955",
decimals:18
}
]
},

{
name:"POLYGON",
rpc:"https://rpc.ankr.com/polygon",
tokens:[
{
symbol:"USDT",
address:"0xc2132D05D31c914a87C6611C10748AEb04B58e8F",
decimals:6
}
]
}

];


// ===== ERC20 ABI =====
const ERC20_ABI = [
"function balanceOf(address) view returns (uint256)"
];



async function scan(){

const address = document.getElementById("addr").value;
const table = document.getElementById("hasil");

table.innerHTML = "";

for(const chain of CHAINS){

try{

const provider = new ethers.providers.JsonRpcProvider(chain.rpc);

// ===== Native =====
const nativeBal = await provider.getBalance(address);

tambah(chain.name,"NATIVE",ethers.utils.formatEther(nativeBal));

// ===== Tokens =====
for(const token of chain.tokens){

const contract = new ethers.Contract(
token.address,
ERC20_ABI,
provider
);

const bal = await contract.balanceOf(address);

const formatted = bal / Math.pow(10,token.decimals);

if(formatted > 0){
tambah(chain.name,token.symbol,formatted);
}

}

}catch(e){
console.log(chain.name,"error");
}

}

}



function tambah(net,sym,bal){

document.getElementById("hasil").innerHTML += `
<tr>
<td>${net}</td>
<td>${sym}</td>
<td>${Number(bal).toFixed(4)}</td>
</tr>
`;

}

</script>

</body>
</html>
