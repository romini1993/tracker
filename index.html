<!DOCTYPE html>
<html lang="en">
<head>
    <title>EVM Multi-Chain Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-6 text-center">EVM Portfolio Tracker</h1>
        
        <div class="flex gap-2 mb-8">
            <input id="walletAddress" type="text" placeholder="Paste EVM Address (0x...)" 
                class="w-full p-3 rounded bg-gray-800 border border-gray-700 focus:outline-none focus:border-blue-500">
            <button onclick="trackAssets()" class="bg-blue-600 hover:bg-blue-700 px-6 py-3 rounded font-bold">Check</button>
        </div>

        <div id="loading" class="hidden text-center my-4 text-yellow-500 italic">Lagi nyeken koin elu, sabar Bro...</div>

        <div class="bg-gray-800 rounded-lg overflow-hidden">
            <table class="w-full text-left">
                <thead class="bg-gray-700">
                    <tr>
                        <th class="p-4">Chain</th>
                        <th class="p-4">Token</th>
                        <th class="p-4">Balance</th>
                        <th class="p-4">Action</th>
                    </tr>
                </thead>
                <tbody id="resultTable">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        async function trackAssets() {
            const address = document.getElementById('walletAddress').value.trim();
            const table = document.getElementById('resultTable');
            const loader = document.getElementById('loading');

            if (!address.startsWith('0x')) return alert('Address-nya salah tuh, Bro!');

            table.innerHTML = '';
            loader.classList.remove('hidden');

            // List RPC Publik (Bisa ditambahin lagi)
            const endpoints = [
                { name: 'Ethereum', url: 'https://rpc.ankr.com/eth' },
                { name: 'BSC', url: 'https://rpc.ankr.com/bsc' },
                { name: 'Polygon', url: 'https://rpc.ankr.com/polygon' },
                { name: 'Arbitrum', url: 'https://rpc.ankr.com/arbitrum' }
            ];

            // Pake API Ankr Public buat Multi-Chain
            try {
                const response = await fetch(`https://rpc.ankr.com/multichain`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        jsonrpc: "2.0",
                        method: "ankr_getAccountBalance",
                        params: { walletAddress: address },
                        id: 1
                    })
                });

                const data = await response.json();
                const assets = data.result.assets;

                loader.classList.add('hidden');

                if (assets.length === 0) {
                    table.innerHTML = '<tr><td colspan="4" class="p-4 text-center">Koin nggak ketemu atau address kosong.</td></tr>';
                    return;
                }

                assets.forEach(asset => {
                    const row = `
                        <tr class="border-b border-gray-700 hover:bg-gray-750">
                            <td class="p-4 text-sm">${asset.blockchain}</td>
                            <td class="p-4 font-bold">${asset.tokenSymbol}</td>
                            <td class="p-4 text-green-400">${parseFloat(asset.balance).toFixed(4)}</td>
                            <td class="p-4 text-blue-400 cursor-pointer hover:underline" onclick="copyText('${asset.tokenAddress}')">
                                Copy Contract
                            </td>
                        </tr>
                    `;
                    table.innerHTML += row;
                });

            } catch (err) {
                console.error(err);
                loader.classList.add('hidden');
                alert('Gagal narik data. Coba lagi nanti ya, Bro.');
            }
        }

        function copyText(text) {
            navigator.clipboard.writeText(text);
            alert('Contract copied: ' + text);
        }
    </script>
</body>
</html>
